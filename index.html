<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UltraXweb</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <style>
    :root {
      --main: #4CAF50;
      --second: #2E7D32;
      --bg: #0a0a0a;
      --text: #f2f2f2;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Arial', sans-serif;
    }

    body {
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      position: relative;
    }

    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: rgba(10, 10, 10, 0.9);
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
      border-bottom: 1px solid var(--main);
    }

    .logo {
      font-size: 1.2rem;
      font-weight: bold;
      color: var(--main);
    }

    .logo span {
      color: #F1222;
      font-weight: normal;
    }

    /* Hamburger Menu */
    .hamburger {
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .hamburger-line {
      width: 25px;
      height: 3px;
      background-color: var(--main);
      transition: all 0.3s;
    }

    /* Side Menu */
    .side-menu {
      position: fixed;
      top: 0;
      left: -300px;
      width: 250px;
      height: 100%;
      background: rgba(10, 10, 10, 0.95);
      border-right: 1px solid var(--main);
      z-index: 999;
      padding: 70px 20px 20px;
      transition: all 0.3s;
    }

    .side-menu.active {
      left: 0;
    }

    .menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 998;
      display: none;
    }

    .menu-overlay.active {
      display: block;
    }

    .menu-item {
      padding: 12px 15px;
      border-radius: 8px;
      margin-bottom: 5px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .menu-item:hover {
      background: rgba(76, 175, 80, 0.1);
    }

    .menu-item i {
      width: 20px;
      text-align: center;
    }

    /* Main Content */
    .main-content {
      padding: 80px 20px 20px;
      max-width: 800px;
      margin: 0 auto;
    }

    .card {
      background: rgba(76, 175, 80, 0.03);
      border: 1px solid rgba(76, 175, 80, 0.2);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      backdrop-filter: blur(10px);
    }

    .card h2 {
      color: var(--main);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    /* Form Styles */
    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      color: #aaa;
    }

    .form-control {
      background: rgba(255, 255, 255, 0.05);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 10px;
      width: 100%;
    }

    .btn {
      padding: 10px 15px;
      border-radius: 8px;
      border: none;
      background: var(--main);
      color: white;
      cursor: pointer;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn:hover {
      background: var(--second);
    }

    /* Dashboard Info */
    .info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }

    .info-item {
      background: rgba(76, 175, 80, 0.05);
      border: 1px solid rgba(76, 175, 80, 0.1);
      border-radius: 8px;
      padding: 15px;
    }

    .info-label {
      color: #aaa;
      font-size: 0.9rem;
      margin-bottom: 5px;
    }

    .info-value {
      font-size: 1.1rem;
    }

    /* Hidden class */
    .hidden {
      display: none;
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .fade-in {
      animation: fadeIn 0.3s forwards;
    }

    /* Loading spinner */
    .spinner {
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- Header with Hamburger -->
  <div class="header">
    <div class="hamburger" id="hamburger">
      <div class="hamburger-line"></div>
      <div class="hamburger-line"></div>
      <div class="hamburger-line"></div>
    </div>
    <div class="logo">UltraXweb <span>@F1222</span></div>
    <div></div> <!-- Spacer -->
  </div>

  <!-- Side Menu -->
  <div class="side-menu" id="sideMenu">
    <!-- Menu items will be populated by JavaScript -->
  </div>
  <div class="menu-overlay" id="menuOverlay"></div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Login Form -->
    <div class="card" id="loginCard">
      <h2><i class="fas fa-sign-in-alt"></i> Login</h2>
      <div class="form-group">
        <label>Username</label>
        <input type="text" id="username" class="form-control">
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="password" class="form-control">
      </div>
      <button class="btn" onclick="login()" id="loginBtn">
        <i class="fas fa-sign-in-alt"></i> Login
      </button>
      <div id="loginResult" style="margin-top: 15px;"></div>
    </div>

    <!-- Dashboard -->
    <div class="card hidden" id="dashboard">
      <h2><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
      <div class="info-grid">
        <div class="info-item">
          <div class="info-label">Username</div>
          <div class="info-value" id="infoUsername">-</div>
        </div>
        <div class="info-item">
          <div class="info-label">Password</div>
          <div class="info-value" id="infoPassword">••••••••</div>
        </div>
        <div class="info-item">
          <div class="info-label">Role</div>
          <div class="info-value" id="infoRole">-</div>
        </div>
        <div class="info-item">
          <div class="info-label">Device ID</div>
          <div class="info-value" id="infoDeviceId">-</div>
        </div>
      </div>
    </div>

    <!-- My Info -->
    <div class="card hidden fade-in" id="myInfo">
      <h2><i class="fas fa-user"></i> My Info</h2>
      <div class="form-group">
        <label>Username</label>
        <input type="text" id="myInfoUsername" class="form-control" readonly>
      </div>
      <div class="form-group">
        <label>Role</label>
        <input type="text" id="myInfoRole" class="form-control" readonly>
      </div>
      <div class="form-group">
        <label>Device ID</label>
        <input type="text" id="myInfoDeviceId" class="form-control" readonly>
      </div>
      <button class="btn" onclick="hideAllMenus()">
        <i class="fas fa-times"></i> Close
      </button>
    </div>

    <!-- Attack Menu -->
    <div class="card hidden fade-in" id="attackMenu">
      <h2><i class="fas fa-bolt"></i> Attack Menu</h2>
      <div class="form-group">
        <label>Target</label>
        <input type="text" id="attackTarget" class="form-control" placeholder="Enter target">
      </div>
      <div class="form-group">
        <label>Attack Type</label>
        <select id="attackType" class="form-control">
          <option value="crash">Crash</option>
          <option value="delay">Delay</option>
          <option value="invisible">Invisible</option>
        </select>
      </div>
      <button class="btn" onclick="launchAttack()" id="attackBtn">
        <i class="fas fa-paper-plane"></i> Launch Attack
      </button>
      <button class="btn" onclick="hideAllMenus()" style="margin-left: 10px;">
        <i class="fas fa-times"></i> Close
      </button>
      <div id="attackResult" style="margin-top: 15px;"></div>
    </div>

    <!-- Reseller Menu -->
    <div class="card hidden fade-in" id="resellerMenu">
      <h2><i class="fas fa-user-tag"></i> Reseller Menu</h2>
      <div class="form-group">
        <label>Username</label>
        <input type="text" id="resellerUsername" class="form-control" placeholder="New username">
      </div>
      <div class="form-group">
        <label>Password</label>
        <input type="password" id="resellerPassword" class="form-control" placeholder="New password">
      </div>
      <div class="form-group">
        <label>Days</label>
        <select id="resellerDays" class="form-control">
          <option value="1">1 Day</option>
          <option value="7">7 Days</option>
          <option value="30">30 Days</option>
        </select>
      </div>
      <button class="btn" onclick="createResellerUser()" id="resellerBtn">
        <i class="fas fa-user-plus"></i> Create User
      </button>
      <button class="btn" onclick="hideAllMenus()" style="margin-left: 10px;">
        <i class="fas fa-times"></i> Close
      </button>
      <div id="resellerResult" style="margin-top: 15px;"></div>
    </div>

    <!-- Admin Menu -->
    <div class="card hidden fade-in" id="adminMenu">
      <h2><i class="fas fa-user-shield"></i> Admin Menu</h2>
      <div class="form-group">
        <label>Username to Delete</label>
        <input type="text" id="adminDeleteUsername" class="form-control" placeholder="Username to delete">
      </div>
      <button class="btn btn-danger" onclick="deleteUser()" id="deleteBtn">
        <i class="fas fa-trash"></i> Delete User
      </button>
      <button class="btn" onclick="hideAllMenus()" style="margin-left: 10px;">
        <i class="fas fa-times"></i> Close
      </button>
      <div id="adminResult" style="margin-top: 15px;"></div>
    </div>
  </div>

  <script>
    // JSONBin configuration
    const BIN_ID = "688384cdae596e708fbb97e4"; // Replace with your actual bin ID
    const API_KEY = "$2a$10$55IAjRl7i3QlilxdTPmqx.5/Idiemz453V9zHKc76Z9q4jDPhvL.C"; // Replace with your actual API key
    const headers = {
      "Content-Type": "application/json",
      "X-Master-Key": API_KEY
    };

    // Global variables
    let currentUser = null;
    let localDeviceId = localStorage.getItem('device_id');
    if (!localDeviceId) {
      localDeviceId = generateDeviceId();
      localStorage.setItem('device_id', localDeviceId);
    }

    // Generate device ID
    function generateDeviceId() {
      return Math.random().toString(36).substring(2, 15);
    }

    // DOM elements
    const hamburger = document.getElementById('hamburger');
    const sideMenu = document.getElementById('sideMenu');
    const menuOverlay = document.getElementById('menuOverlay');
    const loginCard = document.getElementById('loginCard');
    const dashboard = document.getElementById('dashboard');

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      // Check if user is already logged in
      const user = JSON.parse(localStorage.getItem('currentUser'));
      if (user) {
        currentUser = user;
        showDashboard();
      }

      // Hamburger menu click event
      hamburger.addEventListener('click', toggleMenu);
      menuOverlay.addEventListener('click', toggleMenu);
    });

    // Toggle side menu
    function toggleMenu() {
      sideMenu.classList.toggle('active');
      menuOverlay.classList.toggle('active');
    }

    // Hide all menu cards
    function hideAllMenus() {
      document.querySelectorAll('.card').forEach(card => {
        if (!card.id.includes('loginCard') && !card.id.includes('dashboard')) {
          card.classList.add('hidden');
        }
      });
      toggleMenu();
    }

    // Show specific menu card
    function showMenu(menuId) {
      hideAllMenus();
      document.getElementById(menuId).classList.remove('hidden');
    }

    // Update side menu based on user role
    function updateSideMenu() {
      sideMenu.innerHTML = '';
      
      if (!currentUser) return;

      // Common menu items
      const menuItems = [];
      
      menuItems.push(
        { icon: 'fa-user', text: 'My Info', action: () => showMenu('myInfo') }
      );

      if (currentUser.role === 'admin' || currentUser.role === 'reseller') {
        menuItems.push(
          { icon: 'fa-bolt', text: 'Attack Menu', action: () => showMenu('attackMenu') }
        );
      }

      if (currentUser.role === 'admin') {
        menuItems.push(
          { icon: 'fa-user-tag', text: 'Reseller Menu', action: () => showMenu('resellerMenu') },
          { icon: 'fa-user-shield', text: 'Admin Menu', action: () => showMenu('adminMenu') }
        );
      }

      // Add menu items to side menu
      menuItems.forEach(item => {
        const menuItem = document.createElement('div');
        menuItem.className = 'menu-item';
        menuItem.innerHTML = `<i class="fas ${item.icon}"></i> ${item.text}`;
        menuItem.addEventListener('click', item.action);
        sideMenu.appendChild(menuItem);
      });

      // Add logout button
      const logoutItem = document.createElement('div');
      logoutItem.className = 'menu-item';
      logoutItem.innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
      logoutItem.addEventListener('click', logout);
      logoutItem.style.marginTop = '20px';
      logoutItem.style.color = '#f44336';
      sideMenu.appendChild(logoutItem);
    }

    // Get users from JSONBin
    async function getUsers() {
      try {
        const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, { headers });
        const data = await response.json();
        return data.record;
      } catch (error) {
        console.error('Error fetching users:', error);
        return [];
      }
    }

    // Update users in JSONBin
    async function updateUsers(users) {
      try {
        const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
          method: 'PUT',
          headers,
          body: JSON.stringify(users)
        });
        return await response.json();
      } catch (error) {
        console.error('Error updating users:', error);
        return null;
      }
    }

    // Login function
    async function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const loginResult = document.getElementById('loginResult');
      const loginBtn = document.getElementById('loginBtn');

      if (!username || !password) {
        loginResult.innerHTML = 'Please enter username and password';
        loginResult.style.color = '#f44336';
        return;
      }

      // Show loading state
      loginBtn.innerHTML = '<i class="fas fa-spinner spinner"></i> Logging in...';
      loginBtn.disabled = true;

      try {
        const users = await getUsers();
        const user = users.find(u => u.username === username && u.password === password);

        if (!user) {
          loginResult.innerHTML = 'Invalid username or password';
          loginResult.style.color = '#f44336';
          return;
        }

        // Check if account is already in use on another device
        if (user.device_id && user.device_id !== localDeviceId) {
          loginResult.innerHTML = 'Account is already in use on another device';
          loginResult.style.color = '#f44336';
          return;
        }

        // Update user device ID
        user.device_id = localDeviceId;
        const updatedUsers = users.map(u => u.username === user.username ? user : u);
        await updateUsers(updatedUsers);

        currentUser = user;
        localStorage.setItem('currentUser', JSON.stringify(user));
        showDashboard();
      } catch (error) {
        loginResult.innerHTML = 'Login failed: ' + error.message;
        loginResult.style.color = '#f44336';
      } finally {
        loginBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
        loginBtn.disabled = false;
      }
    }

    // Show dashboard
    function showDashboard() {
      loginCard.classList.add('hidden');
      dashboard.classList.remove('hidden');
      
      // Update dashboard info
      document.getElementById('infoUsername').textContent = currentUser.username;
      document.getElementById('infoRole').textContent = currentUser.role;
      document.getElementById('infoDeviceId').textContent = localDeviceId;
      
      // Update My Info
      document.getElementById('myInfoUsername').value = currentUser.username;
      document.getElementById('myInfoRole').value = currentUser.role;
      document.getElementById('myInfoDeviceId').value = localDeviceId;
      
      updateSideMenu();
    }

    // Logout function
    async function logout() {
      try {
        if (currentUser) {
          const users = await getUsers();
          const updatedUsers = users.map(u => {
            if (u.username === currentUser.username) {
              return { ...u, device_id: '' };
            }
            return u;
          });
          await updateUsers(updatedUsers);
        }
      } catch (error) {
        console.error('Error during logout:', error);
      } finally {
        currentUser = null;
        localStorage.removeItem('currentUser');
        loginCard.classList.remove('hidden');
        dashboard.classList.add('hidden');
        hideAllMenus();
        document.getElementById('username').value = '';
        document.getElementById('password').value = '';
      }
    }

    // Launch attack
    async function launchAttack() {
      const target = document.getElementById('attackTarget').value;
      const attackType = document.getElementById('attackType').value;
      const attackResult = document.getElementById('attackResult');
      const attackBtn = document.getElementById('attackBtn');

      if (!target) {
        attackResult.innerHTML = 'Please enter target';
        attackResult.style.color = '#f44336';
        return;
      }

      // Show loading state
      attackBtn.innerHTML = '<i class="fas fa-spinner spinner"></i> Launching...';
      attackBtn.disabled = true;

      try {
        // Simulate API call
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        attackResult.innerHTML = `Attack (${attackType}) launched successfully to ${target}`;
        attackResult.style.color = 'var(--main)';
      } catch (error) {
        attackResult.innerHTML = 'Attack failed: ' + error.message;
        attackResult.style.color = '#f44336';
      } finally {
        attackBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Launch Attack';
        attackBtn.disabled = false;
      }
    }

    // Create reseller user
    async function createResellerUser() {
      const username = document.getElementById('resellerUsername').value;
      const password = document.getElementById('resellerPassword').value;
      const days = document.getElementById('resellerDays').value;
      const resellerResult = document.getElementById('resellerResult');
      const resellerBtn = document.getElementById('resellerBtn');

      if (!username || !password) {
        resellerResult.innerHTML = 'Please fill all fields';
        resellerResult.style.color = '#f44336';
        return;
      }

      // Show loading state
      resellerBtn.innerHTML = '<i class="fas fa-spinner spinner"></i> Creating...';
      resellerBtn.disabled = true;

      try {
        const users = await getUsers();
        
        // Check if username already exists
        if (users.some(u => u.username === username)) {
          resellerResult.innerHTML = 'Username already exists';
          resellerResult.style.color = '#f44336';
          return;
        }

        // Calculate expiration date
        const expiredDate = new Date();
        expiredDate.setDate(expiredDate.getDate() + parseInt(days));

        const newUser = {
          username,
          password,
          role: 'user', // Reseller can only create regular users
          telegram_id: null,
          device_id: '',
          expired: expiredDate.toISOString().split('T')[0]
        };

        const updatedUsers = [...users, newUser];
        await updateUsers(updatedUsers);

        resellerResult.innerHTML = `User ${username} created successfully with ${days} days access`;
        resellerResult.style.color = 'var(--main)';
        
        // Clear form
        document.getElementById('resellerUsername').value = '';
        document.getElementById('resellerPassword').value = '';
      } catch (error) {
        resellerResult.innerHTML = 'Error creating user: ' + error.message;
        resellerResult.style.color = '#f44336';
      } finally {
        resellerBtn.innerHTML = '<i class="fas fa-user-plus"></i> Create User';
        resellerBtn.disabled = false;
      }
    }

    // Delete user (admin only)
    async function deleteUser() {
      const username = document.getElementById('adminDeleteUsername').value;
      const adminResult = document.getElementById('adminResult');
      const deleteBtn = document.getElementById('deleteBtn');

      if (!username) {
        adminResult.innerHTML = 'Please enter username';
        adminResult.style.color = '#f44336';
        return;
      }

      // Show loading state
      deleteBtn.innerHTML = '<i class="fas fa-spinner spinner"></i> Deleting...';
      deleteBtn.disabled = true;

      try {
        const users = await getUsers();
        
        // Check if user exists
        if (!users.some(u => u.username === username)) {
          adminResult.innerHTML = 'User not found';
          adminResult.style.color = '#f44336';
          return;
        }

        // Can't delete yourself
        if (username === currentUser.username) {
          adminResult.innerHTML = 'Cannot delete your own account';
          adminResult.style.color = '#f44336';
          return;
        }

        const updatedUsers = users.filter(u => u.username !== username);
        await updateUsers(updatedUsers);

        adminResult.innerHTML = `User ${username} deleted successfully`;
        adminResult.style.color = 'var(--main)';
        
        // Clear form
        document.getElementById('adminDeleteUsername').value = '';
      } catch (error) {
        adminResult.innerHTML = 'Error deleting user: ' + error.message;
        adminResult.style.color = '#f44336';
      } finally {
        deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Delete User';
        deleteBtn.disabled = false;
      }
    }
  </script>
</body>
</html>